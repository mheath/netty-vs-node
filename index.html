<!DOCTYPE html>

<!--
  Google HTML5 slide template

  Authors: Luke Mahé (code)
           Marcin Wichary (code and design)
           
           Dominic Mazzoni (browser compatibility)
           Charles Chen (ChromeVox support)

  URL: http://code.google.com/p/html5slides/
-->

<html>
<head>
    <title>Presentation</title>

    <meta charset='utf-8'>
    <meta name="viewport" content="width=980">

    <script src='js/slides/slides.js'></script>
    <!--<script src="js/socket.io/socket.io.min.js"></script>-->
    <!--<script src="js/remote.js"></script>-->

    <script>
    </script>

</head>

<style>
        /* Your individual styles here, or just use inline styles if that’s
     what you want. */
	.indent {
		margin-left: 50px;
	}
	.code {
		height: 550px;
		color: #999;
		margin-top: 20px;
		padding: 20px;
		font-family: 'Courier', 'Courier New', monospace;
		font-weight: bold;
	}
</style>

<body style='display: none'>

<section class='slides layout-regular template-default'>

	<!-- Your slides (<article>s) go here. Delete or comment out the slides below. -->
	<article class='biglogo'>
		<!-- TODO Add Node.js logo -->
		<img src="images/netty_logo_600px.svg" />
	</article>

    <article class='fill'>
		<img src="images/nodejs-900x675.png" />
    </article>

    <article>
        <h1>
            Netty vs. Node.js
        </h1>

        <p>
            Mike Heath
            <br>
            Tom Valletta
        </p>
    </article>

    <article class='fill'>
		<img src="images/apple_vs_orange.jpg" />
	    <h2>Why Netty vs. Node.js?</h2>
    </article>

	<article>
		<h1>Netty</h1>
		<h2>...asynchronous event-driven network application framework...</h2>
	</article>

	<article>
		<h1>Node.js</h1>
		<h2>Evented I/O for V8 JavaScript.</h2>
	</article>


	<article>
		<h2>What does it mean to be event-driven?</h2>
	</article>

    <article class='fill'>
		<img src="images/Classic-Cars-1966-Ford-Mustang.jpg" />
	    <h3>Thread-per-connection Architecture</h3>
    </article>

	<article>
		<h3>Thread-per-connection Architecture</h3>
		<ul class="build">
			<li>Each network connection is handled by its own thread</li>
			<li>Each thread has its own stack for maintaining state</li>
			<li>Apache, Tomcat, JBoss, WebSphere, WebLogic, etc.</li>
		</ul>
	</article>

	<article>
		<h3>Thread-per-connection Pseudo Code Echo Server</h3>
		<!-- TODO find a good monospace font -->
		<div class="build code" style="">
			<p>ServerSocket serverSocket = new ServerSocket(8080);</p>
			<div>
				<p>while (true) {</p>
				<p class="indent">Socket socket = serverSocket.accept();</p>
			</div>
			<div class="indent">
				<p>new Thread() {</p>
				<div class="indent">
					<p>byte[] buffer = socket.read();</p>
					<p>socket.write(buffer);</p>
				</div>
				<p>}.start();</p>
			</div>
			<p>}</p>
		</div>
	</article>

    <article class='fill'>
		<img src="images/honda-air-concept-03.jpg" />
	    <h3>Event-driven Architecture</h3>
    </article>

	<article>
		<h3>Event-driven Architecture</h3>
		<ul class="build">
			<li>More scalable alternative to thread-per-connection architecture</li>
			<li>Single thread handles multiple network connections</li>
			<li>Uses reactor pattern for demultiplexing</li>
			<li>Nginx, Twisted, EventMachine, Grizzly, Netty, Node.js, etc.</li>
		</ul>
	</article>

	<article>
		<h3>Event-driven Psuedo Code</h3>
		<div class="code build">
			<div>
				<p>ServerSocket serverSocket = new ServerSocket(8080);</p>
				<p>Set&lt;Socket&gt; sockets = new Set();</p>
				<p>sockets.add(serverSocket);
			</div>
			<p>while (1) {</p>
			<div class="indent">
				<p>event = select(sockets);</p>
				<p>if (event is connectionEvent) {</p>
				<p class="indent">sockets.add(event.socket);</p>
				<p>}</p>
				<p>processEvent(event);</p>
			</div>
			<p>}</p>
		</div>
	</article>

	<article>
		<h3>Event-driven Architecture Myths</h3>
		<ul class="build">
			<li>Thread scheduling and context switching are expensive</li>
			<li>Event-driven servers are always faster</li>
			<li>Threads don't really need 2MB of physical memory for their stack</li>
			<li>Thread-per-connection servers can't scale to 10,000+ connections</li>
		</ul>
	</article>

	<article>
		<h3>When to use an event-driven architecture?</h3>
		<ul class="build">
			<li>Front-end server that does mostly pass-through work</li>
			<li>Long-lived network connections that are often idle
				<ul>
					<li>Web sockets</li>
					<li>Comet</li>
				</ul>
			</li>
		</ul>
	</article>

    <article class='fill'>
		<img src="images/fight.png" />
	    <h3>Enough talk, let's fight</h3>
    </article>

	<article>
		<h3>Node.js</h3>
		<ul class="build">
			<li>Set of libraries on top of V8 to do networking things -ry</li>
			<li>Almost no function in Node directly performs I/O, so the process never blocks.</li>
			<li>Node can do a lot of things at once</li>
		</ul>
	</article>
	
	<article>
		<h3>Node.js - Why JavaScript?</h3>
		<ul class="build">
			<li>JavaScript is non-blocking</li>
			<li>The web runs JavaScript</li>
			<li>Why not?</li>
		</ul>
	</article>
	
	<article>
		<h3>Node.js - Command Line</h3>
		<ul class="build">
			<li>process.pid</li>
			<li>process.platform</li>
			<li>process.versions</li>
			<li>process.memoryUsage()</li>
		</ul>
	</article>
	
	<article>
		<h3>Node Scripts</h3>
<pre>
setTimeout(function() {
	console.log("world");
}, 1000)
console.log("hello");
</pre>
	</article>
	<article>
		<h3>Classical Java Equivalent</h3>
<pre>
try {
	System.out.println("hello");
	Thread.currentThread().sleep(1000);
	System.out.println("world");
}
catch(InteruptedException ie) {
	//If this thread was intrrupted by nother thread 
}
</pre>
	</article>
	
	<article>
		<h3>Node Web Server</h3>
<pre>
var http = require('http');

var s = http.createServer(function(req, res) {
	res.writeHead(200, {'content-type': 'text/plain'});
	res.end("hello world!");
});

s.listen(8000);
</pre>
	</article>

	<article>
		<h3>Node Chat Client</h3>
<pre>
var net = require('net'), sockets = [];
var s = net.Server(function(socket) {
    sockets.push(socket);
    socket.on('data', function(d) {
        for (var i = 0; i < sockets.length; i++) {
            if (sockets[i] == socket) continue;
            sockets[i].write(d);
        }
    });
    socket.on('end', function() {
        var i = sockets.indexOf(socket);
        sockets.splice(i, 1);
    });
});
s.listen(8089);
</pre>
	</article>

	<article class='fill'>
		<h3>Node Inspector</h3>
		<img src="images/overview.png" />
	</article>
	
	<article class='fill'>
		<h3>Node Inspector</h3>
		<img src="images/heap.png" />
	</article>
	
	<article>
		<h3>Modules</h3>
		<ul class="build">
			<li>npm</li>
			<li>socket.io</li>
			<li>express</li>
			<li>hundreds more</li>
		</ul>
	</article>

	<article>
		<h3>Modules Examples</h3>
		<ul class="build">
			<li>Templating: 45</li>
			<li>Build/Deployment: 31</li>
			<li>Message Queues: 5</li>
			<li>Testing Frameworks: 47</li>
			<li>Compression: 12</li>
			<li>I18n and L10n: 10</li>
		</ul>
	</article>

	<article>
		<h3>Documentation</h3>
		<ul class="build">
			<li>Good API Documentation</li>
			<li>7 free node.js books</li>
		</ul>
	</article>

	<article>
		<h2>Netty</h2>
	</article>

	<article>
		<h3>Netty History</h3>
		<ul class="build">
			<li>Started in 2003</li>
			<li>Migrated to Apache Software Foundation as Apache MINA</li>
			<li>Left Apache and moved to Red Hat/JBoss in 2008</li>
		</ul>
	</article>
	
	<article>
		<h3>Netty Architecture</h3>
		<div style="margin: 25px;   ">
			<img src="images/netty-architecture.png" width="100%" />
		</div>
	</article>

	<article>
		<h3>Key Netty Features</h3>
		<ul class="build">
			<li>Unified event API for Sockets, UDP, SCTP, Infiniband</li>
			<li>Minimizes memory copies</li>
			<li>Fair read/write ratio</li>
			<li>Customizable thread model</li>
		</ul>
	</article>

	<article>
		<h3>Netty Pipeline</h3>
		<div style="margin: 25px; text-align: center">
			<img src="images/netty_pipeline_after.png" height="90%" />
		</div>
	</article>

	<article>
		<h2>Netty Demo</h2>
	</article>

	<article>
		<h3>Projects built on Netty</h3>
		<ul>
			<li>Node.x (just had 0.1 release Monday, Oct. 10)</li>
			<li>Akka - Scala distributed actor based framework</li>
			<li>Netty Tools - Simplifies common tasks in Netty</li>
			<li>AsyncHttpClient - Written by Jean-Francois Arcand (creator of Grizzly)</li>
			<li>ADBCJ - Asynchronous Database Client</li>
			<li>Play - Scala based web framework</li>
			<li>PS3 Media Server</li>
		</ul>
	</article>

</section>

</body>
</html>
